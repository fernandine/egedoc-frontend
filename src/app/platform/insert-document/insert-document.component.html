<div class="card p-3">
  <p-toast></p-toast>
  <p-toolbar styleClass="mb-4 gap-2">
    <ng-template pTemplate="left">
      <button pButton pRipple label="Novo arquivo" icon="pi pi-plus mr-2" class="p-button-success mr-2"
        (click)="openNew()"></button>
      <button pButton pRipple label="Apagar" icon="pi pi-trash mr-2" class="p-button-danger"
        (click)="deleteDocument(document)" [disabled]="!selected || !selected.length"></button>
    </ng-template>

    <ng-template pTemplate="right">
      <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Importar"
        class="mr-2 inline-block"></p-fileUpload>
      <button pButton pRipple label="Exportar" icon="pi pi-upload mr-2" class="ml-3 p-button-help"></button>
    </ng-template>
  </p-toolbar>

  <div pDroppable (onDrop)="onDrop($event)">

    <p-table #dt [value]="documents" [rows]="10" [paginator]="true"
      [globalFilterFields]="['title', 'creationDate', 'code']" [tableStyle]="{ 'min-width': '75rem' }"
      [(selection)]="selected" [rowHover]="true" dataKey="id"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [showCurrentPageReport]="true">
      <ng-template pTemplate="caption">
        <div class="flex align-items-center justify-content-between">
          <h5 class="m-0">Gerenciar Documentos</h5>
        </div>
      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th style="width: 4rem">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th></th>
          <th pSortableColumn="title" style="min-width:15rem">Título <p-sortIcon field="title"></p-sortIcon></th>
          <th pSortableColumn="creationDate">Data de criação <p-sortIcon field="creationDate"></p-sortIcon></th>
          <th pSortableColumn="code" style="min-width:10rem">Código <p-sortIcon field="code"></p-sortIcon></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-document>
        <tr>
          <td>
            <p-tableCheckbox [value]="document"></p-tableCheckbox>
          </td>
          <td><i class="pi pi-file text-2xl"></i></td>
          <td>{{ document.title }}</td>
          <td>{{ document.creationDate | date:"dd/MM/yyyy" }}</td>
          <td>{{ document.id }}</td>
          <td><i class="pi pi-eye" (click)="showAccessList(document)"></i></td>
          <td><i class="pi pi-thumbs-up"></i></td>
          <td><i class="pi pi-star"></i></td>
          <td><i class="pi pi-comment"></i></td>
          <td><i class="pi pi-share-alt"></i></td>

          <td>
            <p-menu appendTo="body" #menu [model]="items" [popup]="true"></p-menu>
            <button pButton pRipple (click)="menu.toggle($event)" icon="pi pi-bars" class="p-button-rounded p-button-warning"></button>
           </td>
        </tr>

      </ng-template>
      <ng-template pTemplate="summary">
        <div class="flex align-items-center justify-content-between">Total de documentos: {{ documents ?
          documents.length : 0 }}</div>
      </ng-template>
    </p-table>
    <div>
    </div>
  </div>
</div>

  <div class="drag-drop-container" (dragover)="onDragOver($event)" (drop)="onDrop($event)"
    (click)="fileInput.click()">
    <div>
      <i class="pi pi-upload text-2xl mb-2"></i>
      <h3 class="text-yellow-500 mb-1">Arraste e solte arquivos aqui</h3>
      <p>Solte os arquivos nesta área ou clique para fazer o upload.</p>
    </div>
  <input type="file" #fileInput style="display: none" (change)="onFileInputChange($event)">
</div>
<br><br>


<p-dialog header="Lista de Acesso" [(visible)]="visible" [modal]="true" [style]="{width: '50vw'}" [draggable]="false" [resizable]="false">
  <ul *ngFor="let user of users">
    <li>{{ user.name }}</li>
  </ul>
</p-dialog>
